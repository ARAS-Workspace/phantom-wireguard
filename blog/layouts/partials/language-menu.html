<!--suppress HtmlUnknownTarget -->
<ul class="menu menu--desktop menu--language-selector">
  <li class="menu__trigger">{{ .Language.LanguageName }}&nbsp;â–¾</li>
  <li>
    <ul class="menu__dropdown">
      {{ if .IsTranslated }}
        {{ range .Translations }}
          <li><a href="{{ .Permalink }}" data-lang="{{ .Language.Lang }}">{{ .Language.LanguageName }}</a></li>
        {{ end }}
      {{ else }}
        {{ range $.Site.Home.AllTranslations }}
          <li><a href="{{ .Permalink }}" data-lang="{{ .Language.Lang }}">{{ .Language.LanguageName }}</a></li>
        {{ end }}
      {{ end }}
    </ul>
  </li>
</ul>
<script>
  (function() {
    // Save language preference on click
    document.querySelectorAll('.menu--language-selector a[data-lang]').forEach(function(link) {
      link.addEventListener('click', function() {
        localStorage.setItem('phantom-lang', this.getAttribute('data-lang'));
      });
    });
    // Redirect on first visit if preference exists
    const pref = localStorage.getItem('phantom-lang');
    if (pref) {
      const lang = document.documentElement.lang;
      const path = window.location.pathname;
      if (pref === 'en' && lang !== 'en') {
        window.location.replace('/en' + path);
      } else if (pref === 'tr' && lang === 'en') {
        window.location.replace(path.replace(/^\/en/, '') || '/');
      }
    }
  })();
</script>